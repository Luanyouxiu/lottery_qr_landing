<!--
å•æ–‡ä»¶æŠ½å¥–é¡µé¢ï¼ˆHTMLï¼‰
è¯´æ˜ï¼š
- å°†æ­¤æ–‡ä»¶ä¿å­˜ä¸º lottery_qr_landing.html ååœ¨æµè§ˆå™¨æ‰“å¼€å³å¯é¢„è§ˆï¼ˆæ”¯æŒæœ¬åœ°æˆ–æ”¾åˆ°æœåŠ¡å™¨ï¼‰ã€‚
- æŠŠä½ çš„äºŒç»´ç å›¾ç‰‡å‘½åä¸º `qrcode.png` æ”¾åœ¨åŒä¸€ç›®å½•ï¼Œæˆ–åœ¨ä¸‹é¢çš„ <img id="qrImg"> ä¸­æ›¿æ¢ src ä¸ºä½ çš„äºŒç»´ç  URLã€‚
- é¡µé¢åŒ…å«ï¼šä¸»å®£ä¼ é¡µï¼ˆå¸¦äºŒç»´ç ï¼‰ï¼Œæ‰«ç /ç‚¹å‡»äºŒç»´ç è¿›å…¥æŠ½å¥–é¡µï¼ŒæŠ½å¥–é¡µå±•ç¤ºå¥–é¡¹å¹¶æ¨¡æ‹ŸæŠ½å¥–åŠ¨ç”»ä¸ç»“æœå¼¹çª—ã€‚
- å¦‚éœ€æˆ‘æŠŠä½ æä¾›çš„äºŒç»´ç /å¥–å“å›¾ç‰‡å†…åµŒåˆ°é¡µé¢é‡Œï¼Œç›´æ¥æŠŠå›¾ç‰‡å‘æ¥æˆ‘å¯æ›¿ä½ æ›¿æ¢ã€‚
-->

<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>æ˜Ÿé¢œå›½é™… â€” å¹´ç»ˆæŠ½å¥–</title>
  <style>
    :root{--red:#b90f0f;--soft:#f7f0ef;--gold:#d8a24f}
    *{box-sizing:border-box;font-family: -apple-system, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Microsoft YaHei", Arial}
    body{margin:0;background:linear-gradient(180deg,#fff 0%, #fff 55%, #f3f1ef 55%);color:#222}

    /* Landing */
    .hero{background:linear-gradient(0deg,var(--red),#a61010);color:#fff;padding:22px 16px 36px}
    .container{max-width:960px;margin:0 auto}
    .top-row{display:flex;gap:16px;align-items:center}
    .left{flex:1}
    .brand{font-size:20px;font-weight:700}
    .title{font-size:34px;font-weight:800;margin:8px 0}
    .card{background:#fff;border-radius:10px;padding:14px;color:#333}
    .price{font-size:42px;color:var(--red);font-weight:800}
    .qr-wrap{width:220px;flex:0 0 220px;text-align:center}
    .qr{width:160px;height:160px;border-radius:8px;background:#fff;padding:10px;display:inline-block}
    .qr img{width:100%;height:100%;object-fit:contain}
    .scan-tip{margin-top:8px;color:#ffd9d9}

    /* Button */
    .btn{display:inline-block;background:var(--gold);color:#fff;padding:10px 18px;border-radius:999px;font-weight:700;text-decoration:none}

    /* Lottery page */
    .lottery{display:none;padding:18px}
    .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;max-width:760px;margin:8px auto}
    .prize{background:linear-gradient(180deg,#fff,#fdecea);border-radius:12px;padding:12px;text-align:center;box-shadow:0 6px 18px rgba(0,0,0,0.08)}
    .prize img{width:100%;height:100px;object-fit:contain}
    .prize .label{margin-top:8px;font-weight:700}

    .center{display:flex;flex-direction:column;align-items:center;justify-content:center}
    .spin-btn{margin-top:10px;padding:14px 28px;background:var(--red);color:#fff;border:none;border-radius:12px;font-size:18px;font-weight:800}

    /* Modal */
    .modal{position:fixed;inset:0;background:rgba(0,0,0,0.5);display:flex;align-items:center;justify-content:center;opacity:0;pointer-events:none;transition:all .2s}
    .modal.open{opacity:1;pointer-events:auto}
    .modal-card{background:#fff;padding:22px;border-radius:12px;max-width:320px;text-align:center}
    .modal-card .prize-name{font-size:20px;font-weight:800;margin-top:10px}

    /* small */
    @media(max-width:600px){.top-row{flex-direction:column}.qr-wrap{width:100%}.qr{margin-top:10px}}
  </style>
</head>
<body>
  <div class="hero">
    <div class="container">
      <div class="top-row">
        <div class="left">
          <div class="brand">é¢œå°çµ Â· æ˜Ÿé¢œå›½é™…</div>
          <div class="title">å¹´ç»ˆç™¾ä¸‡è¡¥è´´æ¥è¢­ â€” ä¸€èµ·æ‰“é€ ç´ é¢œç¯æ³¡è‚Œ</div>
          <div style="margin-top:8px;color:#ffe8e8;max-width:680px">é™æ—¶å¿ƒåŠ¨ä»· Â¥299ï¼Œæ¯äººé™è´­1å•ï¼Œä¸‹å•å³é€æŠ½å¥–æœºä¼šï¼Œæ‰«ç æˆ–ç‚¹å‡»å³ä¾§äºŒç»´ç è¿›å…¥æŠ½å¥–é¡µé¢ã€‚</div>
          <div style="margin-top:12px">
            <a class="btn" href="#" id="enterBtn">ç«‹å³æŠ¢è´­ / è¿›å…¥æŠ½å¥–</a>
          </div>
        </div>
        <div class="qr-wrap">
          <div class="card">
            <div style="font-weight:800;margin-bottom:8px">å¿ƒåŠ¨ä½“éªŒ Â¥299</div>
            <div class="qr" title="é•¿æŒ‰è¯†åˆ«äºŒç»´ç æˆ–ç‚¹å‡»è¿›å…¥æŠ½å¥–">
              <!-- è¯·æŠŠä½ çš„äºŒç»´ç æ›¿æ¢ä¸º qrcode.png æˆ–æ›¿æ¢ä¸‹é¢çš„ src -->
              <img id="qrImg" src="qrcode.png" alt="äºŒç»´ç ï¼ˆè¯·æ›¿æ¢ä¸ºçœŸå®äºŒç»´ç ï¼‰">
            </div>
            <div class="scan-tip">é•¿æŒ‰äºŒç»´ç è¿›å…¥æ´»åŠ¨æˆ–ç‚¹å‡»äºŒç»´ç </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Lottery page -->
  <div class="lottery container" id="lotteryPage">
    <h2 style="text-align:center;color:var(--red);">å¹¸è¿æŠ½å¥– Â· å¥–å“åŒº</h2>
    <p style="text-align:center;color:#666">ä¸‹å•å³å¯æŠ½å¥–ï¼Œå¤§å¥–éšæœºæŠ½å–ï¼</p>
    <div class="grid" id="prizeGrid"></div>
    <div class="center">
      <button class="spin-btn" id="spinBtn">ç«‹å³æŠ½å¥–</button>
      <div style="margin-top:8px;color:#666">å‰©ä½™æŠ½å¥–æ¬¡æ•°ï¼š<span id="chance">1</span></div>
    </div>
  </div>

  <!-- Modal -->
  <div class="modal" id="modal">
    <div class="modal-card">
      <div id="modalPrizeImg" style="height:120px"></div>
      <div class="prize-name" id="modalPrizeName"></div>
      <div style="margin-top:12px">
        <button class="btn" id="closeModal">ç¡®å®š</button>
      </div>
    </div>
  </div>

  <script>
    // å¥–å“æ•°æ®ï¼ˆå¯ä»¥æ›¿æ¢å›¾ç‰‡ä¸åç§°ï¼‰
    const prizes = [
      {name: 'è‹¹æœ17æ‰‹æœº', value: 5999, img: ''},
      {name: 'ç›èä¸–å®¶æ‰‹è¡¨', value: 3800, img: ''},
      {name: '888å…ƒçº¢åŒ…', value: 888, img: ''},
      {name: '298å…ƒçœ¼éœœ', value: 298, img: ''},
      {name: 'é¢œå°çµæ°”å«', value: 0, img: ''},
      {name: 'å¹¸è¿çº¢åŒ…', value: 0, img: ''},
      {name: 'Â¥198 é¢è†œ1ç›’', value: 198, img: ''},
      {name: 'Â¥499 æŠ¤è‚¤å¥—è£…', value: 499, img: ''},
      {name: 'å‚ä¸å¥– ä¼˜æƒ åˆ¸', value: 0, img: ''}
    ];

    // æ¸²æŸ“å¥–å“æ ¼å­
    const grid = document.getElementById('prizeGrid');
    function renderGrid(){
      grid.innerHTML = '';
      prizes.forEach((p, i)=>{
        const div = document.createElement('div');
        div.className = 'prize';
        div.innerHTML = `<div style=\"height:100px;display:flex;align-items:center;justify-content:center\">${p.img?'<img src="'+p.img+'">':'<div style=\\"font-size:28px;color:var(--red);font-weight:800\\">'+(p.value?('Â¥'+p.value):'å¥–')+'</div>'}</div><div class=\"label\">${p.name}</div>`;
        grid.appendChild(div);
      });
    }
    renderGrid();

    // ç‚¹å‡»äºŒç»´ç æˆ–æŒ‰é’®è¿›æŠ½å¥–é¡µ
    const qrImg = document.getElementById('qrImg');
    const lotteryPage = document.getElementById('lotteryPage');
    const hero = document.querySelector('.hero');
    function enterLottery(){
      hero.style.display = 'none';
      lotteryPage.style.display = 'block';
      window.scrollTo(0,0);
    }
    qrImg.addEventListener('click', enterLottery);
    document.getElementById('enterBtn').addEventListener('click', (e)=>{e.preventDefault();enterLottery()});

    // æŠ½å¥–é€»è¾‘
    let chances = 1; // å¯æŠ½æ¬¡æ•°
    document.getElementById('chance').textContent = chances;
    const spinBtn = document.getElementById('spinBtn');
    const modal = document.getElementById('modal');
    const modalPrizeName = document.getElementById('modalPrizeName');
    const modalPrizeImg = document.getElementById('modalPrizeImg');
    const closeModal = document.getElementById('closeModal');

    function randomPrizeIndex(){
      // è‡ªå®šä¹‰æ¦‚ç‡ï¼šè¿™é‡Œç¤ºä¾‹ç®€å•æƒé‡ï¼Œå¯æ ¹æ®éœ€è¦æ”¹
      // å¤§å¥–ï¼ˆæ‰‹æœºã€æ‰‹è¡¨ï¼‰æ¦‚ç‡è¾ƒä½
      const weights = [1,1,5,8,10,15,12,10,38];
      const total = weights.reduce((a,b)=>a+b,0);
      let r = Math.random()*total;
      for(let i=0;i<weights.length;i++){
        r -= weights[i];
        if(r<=0) return i;
      }
      return weights.length-1;
    }

    function showModal(prize){
      modalPrizeName.textContent = prize.name + (prize.value?(' â€” Â¥'+prize.value):'');
      modalPrizeImg.innerHTML = prize.img?(`<img src="${prize.img}" style=\"max-width:100%;max-height:100%\">`):('<div style="font-size:36px;color:var(--red);font-weight:900">'+(prize.value?('Â¥'+prize.value):'ğŸ')+'</div>');
      modal.classList.add('open');
    }

    function spinAnimation(finalIndex){
      // ç®€å•çš„é«˜äº®åŠ¨ç”»ï¼šä¾æ¬¡é«˜äº®æ ¼å­
      const cells = Array.from(document.querySelectorAll('.prize'));
      let idx = 0; let rounds = 3; let total = rounds*cells.length + finalIndex;
      let speed = 120; // åˆå§‹é€Ÿåº¦(ms)
      return new Promise((resolve)=>{
        const timer = setInterval(()=>{
          cells.forEach((c,i)=>c.style.boxShadow='0 6px 18px rgba(0,0,0,0.08)');
          cells[idx % cells.length].style.boxShadow = '0 0 0 4px rgba(217,15,15,0.15)';
          idx++;
          if(idx>total){
            clearInterval(timer);
            resolve();
          }
          // åŠ é€Ÿå‡é€Ÿ
        }, Math.max(30, speed -= 1.5));
      });
    }

    spinBtn.addEventListener('click', async ()=>{
      if(chances<=0){alert('æ²¡æœ‰å‰©ä½™æŠ½å¥–æ¬¡æ•°');return}
      spinBtn.disabled = true; spinBtn.textContent = 'æŠ½å¥–è¿›è¡Œä¸­...';
      const index = randomPrizeIndex();
      await spinAnimation(index);
      const prize = prizes[index];
      showModal(prize);
      chances--;
      document.getElementById('chance').textContent = chances;
      spinBtn.disabled = false; spinBtn.textContent = 'ç«‹å³æŠ½å¥–';
    });

    closeModal.addEventListener('click', ()=>{modal.classList.remove('open');});

    // ç‚¹å‡»ç©ºç™½å…³é—­æ¨¡æ€
    modal.addEventListener('click',(e)=>{if(e.target===modal) modal.classList.remove('open')});

    // åˆå§‹ï¼šè‹¥æ‰¾ä¸åˆ° qrcode.pngï¼Œæ˜¾ç¤ºå ä½æ–‡å­—
    (function checkQR(){
      const img = qrImg;
      img.onerror = ()=>{ img.src='data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160"><rect width="100%" height="100%" fill="white"/><text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle" font-size="12" fill="#ccc">è¯·æ›¿æ¢ä¸ºçœŸå®äºŒç»´ç </text></svg>' }
    })();
  </script>
</body>
</html>
