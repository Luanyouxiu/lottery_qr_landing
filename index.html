<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>å¤‡æˆ˜2028å¥¥è¿ä¸“ä¸šå›¢é˜Ÿç‰¹ä¾›Â· ç¾½æ¯›çƒæŠ€èƒ½æŠ½å¥–</title>
  <style>
    :root{--red:#0f6cb9;--soft:#f3f7fb;--gold:#f1b431}
    *{box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,"Helvetica Neue","PingFang SC","Microsoft YaHei",Arial}
    body{margin:0;background:linear-gradient(180deg,#fff 0%,#fff 55%,#eef4f9 55%);color:#222}

    .hero{background:linear-gradient(0deg,var(--red),#084c84);color:#fff;padding:22px 16px 36px}
    .container{max-width:960px;margin:0 auto}
    .top-row{display:flex;gap:16px;align-items:center}
    .left{flex:1}
    .brand{font-size:20px;font-weight:700}
    .title{font-size:32px;font-weight:800;margin:8px 0}
    .card{background:#fff;border-radius:10px;padding:14px;color:#333}
    .price{font-size:42px;color:var(--red);font-weight:800}
    .qr-wrap{width:220px;flex:0 0 220px;text-align:center}
    .qr{width:160px;height:160px;border-radius:8px;background:#fff;padding:10px;display:inline-block}
    .qr img{width:100%;height:100%;object-fit:contain}
    .scan-tip{margin-top:8px;color:#dcecff}

    .btn{display:inline-block;background:var(--gold);color:#fff;padding:10px 18px;border-radius:999px;font-weight:700;text-decoration:none}

    /* åˆ†äº«é¡µ */
    .share{display:none;text-align:center;padding:40px 20px}
    .share h2{color:var(--red)}
    .share button{margin-top:12px}

    /* æŠ½å¥–é¡µ */
    .lottery{display:none;padding:18px}
    .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;max-width:760px;margin:8px auto}
    .prize{background:linear-gradient(180deg,#fff,#e9f2fd);border-radius:12px;padding:12px;text-align:center;box-shadow:0 6px 18px rgba(0,0,0,0.08)}
    .prize img{width:100%;height:100px;object-fit:contain}
    .prize .label{margin-top:8px;font-weight:700}

    .center{display:flex;flex-direction:column;align-items:center;justify-content:center}
    .spin-btn{margin-top:10px;padding:14px 28px;background:var(--red);color:#fff;border:none;border-radius:12px;font-size:18px;font-weight:800}

    .modal{position:fixed;inset:0;background:rgba(0,0,0,0.5);display:flex;align-items:center;justify-content:center;opacity:0;pointer-events:none;transition:all .2s}
    .modal.open{opacity:1;pointer-events:auto}
    .modal-card{background:#fff;padding:22px;border-radius:12px;max-width:320px;text-align:center}
    .modal-card .prize-name{font-size:20px;font-weight:800;margin-top:10px}

    @media(max-width:600px){.top-row{flex-direction:column}.qr-wrap{width:100%}.qr{margin-top:10px}}
  </style>
</head>
<body>
  <div class="hero">
    <div class="container">
      <div class="top-row">
        <div class="left">
          <div class="brand">å¤‡æˆ˜2028å¥¥è¿ä¸“ä¸šå›¢é˜Ÿ</div>
          <div class="title">ç¾½æ¯›çƒè£…å¤‡æŠ½å¥– Â· æŠ€èƒ½éšæœºæ‰è½</div>
          <div style="margin-top:8px;color:#e3f2ff;max-width:680px">
            ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®ï¼Œå³å¯è§£é”ç¥ç§˜æŠ€èƒ½ï¼<br>
            æ‰«ç äºŒç»´ç è¿›å…¥shoppingï¼Œå¿«å»é‚€è¯·æœ‹å‹äº«å—åæŠ˜ä¼˜æƒ ï¼
          </div>
          <div style="margin-top:12px">
            <a class="btn" href="#" id="enterBtn">è¿›å…¥æŠ½å¥–</a>
          </div>
        </div>
        <div class="qr-wrap">
          <div class="card">
            <div style="font-weight:800;margin-bottom:8px">æ‰«ç åŠ å…¥ Â· ä¸å…è´¹è´­ç‰©</div>
            <div class="qr" title="é•¿æŒ‰è¯†åˆ«äºŒç»´ç è¿›å…¥shopping">
              <img id="qrImg" src="frame.png">
            </div>
            <div class="scan-tip">æ‰«å®ƒï¼æ‰«å®ƒï¼</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- åˆ†äº«é¡µ -->
  <div class="share container" id="sharePage">
    <h2>éœéœæœ‹å‹ï¼Œè·å¾—é¢å¤–æŠ½å¥–æœºä¼šï¼</h2>
    <p>åˆ†äº«ä½ çš„ä¸“å±é“¾æ¥ç»™å¥½å‹ï¼Œå¥½å‹ç‚¹å‡»è¿›å…¥åï¼Œä½ å°†è·å¾—1æ¬¡é¢å¤–æŠ½å¥–æœºä¼šã€‚</p>
    <button class="btn" id="copyLink">å¤åˆ¶æˆ‘çš„åˆ†äº«é“¾æ¥</button>
    <div style="margin-top:20px"><a href="#" id="toLottery" class="btn">è¿”å›æŠ½å¥–é¡µé¢</a></div>
  </div>

  <!-- æŠ½å¥–é¡µ -->
  <div class="lottery container" id="lotteryPage">
    <h2 style="text-align:center;color:var(--red);">ç¾½æ¯›çƒç¥ä»™æŠ€èƒ½æŠ½å¥–åŒº</h2>
    <p style="text-align:center;color:#666">æŠ½å‡ºå±äºä½ çš„â€œç¥æŠ€â€ï¼</p>
    <div class="grid" id="prizeGrid"></div>
    <div class="center">
      <button class="spin-btn" id="spinBtn">ç«‹å³æŠ½å¥–</button>
      <div style="margin-top:8px;color:#666">
        å‰©ä½™æŠ½å¥–æ¬¡æ•°ï¼š<span id="chance">1</span> æ¬¡
      </div>
      <div style="margin-top:10px">
        <a href="#" id="shareBtn" class="btn">éœéœæœ‹å‹ +1æ¬¡</a>
      </div>
    </div>
  </div>

  <!-- Modal -->
  <div class="modal" id="modal">
    <div class="modal-card">
      <div id="modalPrizeImg" style="height:120px"></div>
      <div class="prize-name" id="modalPrizeName"></div>
      <div style="margin-top:12px">
        <button class="btn" id="closeModal">ç¡®å®š</button>
      </div>
    </div>
  </div>

  <script>
    // ç¾½æ¯›çƒâ€œå¥–å“â€ï¼ˆæŠ€èƒ½ï¼‰
    const prizes = [
      {name:'20ç±³è·³æ€æŠ€æœ¯', value:0},
      {name:'ç½‘å‰æ»šç½‘ç¥æŠ€', value:0},
      {name:'ç‹‚å·ååœºä¸å‡ºç•Œ', value:0},
      {name:'å‘çƒæ°¸ä¸å‡ºç•Œ', value:0},
      {name:'æ¥æ€ç¨³å¦‚ç‹—æ¨¡å¼', value:0},
      {name:'åŒæ‰“åµæ¶å…ç–«å…‰ç¯', value:0},
      {name:'ä¸‰å±€ä¸¤èƒœå¿…èµ¢å®šå¾‹', value:0},
      {name:'æ‰£æ€ç¬é—´å˜è„¸æ— å½±è„š', value:0},
      {name:'æ¼”å‘˜é˜Ÿå‹ä¸€æš', value:499}
    ];

    // æ¸²æŸ“æ ¼å­
    const grid = document.getElementById('prizeGrid');
    function renderGrid(){
      grid.innerHTML = '';
      prizes.forEach(p=>{
        const div=document.createElement('div');
        div.className='prize';
        div.innerHTML=`<div style="height:100px;display:flex;align-items:center;justify-content:center">
          <div style="font-size:22px;color:var(--red);font-weight:800;text-align:center">${p.name.length>8?p.name.slice(0,8)+'â€¦':p.name}</div>
        </div><div class="label">${p.name}</div>`;
        grid.appendChild(div);
      });
    }
    renderGrid();

    // é¡µé¢æ§åˆ¶
    const hero=document.querySelector('.hero');
    const sharePage=document.getElementById('sharePage');
    const lotteryPage=document.getElementById('lotteryPage');
    function show(page){
      hero.style.display='none';
      sharePage.style.display='none';
      lotteryPage.style.display='none';
      page.style.display='block';
      window.scrollTo(0,0);
    }

    const qrImg=document.getElementById('qrImg');
    qrImg.addEventListener('click',()=>show(lotteryPage));
    document.getElementById('enterBtn').addEventListener('click',e=>{e.preventDefault();show(lotteryPage)});

    // æŠ½å¥–é€»è¾‘
    let chances=1;
    const chanceEl=document.getElementById('chance');
    const spinBtn=document.getElementById('spinBtn');
    const modal=document.getElementById('modal');
    const modalPrizeName=document.getElementById('modalPrizeName');
    const modalPrizeImg=document.getElementById('modalPrizeImg');
    const closeModal=document.getElementById('closeModal');
    chanceEl.textContent=chances;

    function randomPrizeIndex(){
      const weights=[1,3,5,8,8,10,10,12,2];
      const total=weights.reduce((a,b)=>a+b,0);
      let r=Math.random()*total;
      for(let i=0;i<weights.length;i++){r-=weights[i];if(r<=0)return i;}
      return weights.length-1;
    }

    function spinAnimation(finalIndex){
      const cells=Array.from(document.querySelectorAll('.prize'));
      let idx=0;let rounds=3;let total=rounds*cells.length+finalIndex;
      let speed=120;
      return new Promise(resolve=>{
        const timer=setInterval(()=>{
          cells.forEach(c=>c.style.boxShadow='0 6px 18px rgba(0,0,0,0.08)');
          cells[idx%cells.length].style.boxShadow='0 0 0 4px rgba(15,108,185,0.2)';
          idx++;
          if(idx>total){clearInterval(timer);resolve();}
          speed-=1.2;
        },Math.max(30,speed));
      });
    }

    async function spin(){
      if(chances<=0){alert('æŠ½å¥–æ¬¡æ•°ä¸è¶³ï¼Œè¯·å»éœéœæœ‹å‹ï¼');return;}
      spinBtn.disabled=true;spinBtn.textContent='æŠ½å¥–ä¸­...';
      const index=randomPrizeIndex();
      await spinAnimation(index);
      const prize=prizes[index];
      modalPrizeName.textContent=prize.name+(prize.value?(' â€” Â¥'+prize.value):'');
      modalPrizeImg.innerHTML='<div style="font-size:36px;color:var(--red);font-weight:900">ğŸ¸</div>';
      modal.classList.add('open');
      chances--;
      chanceEl.textContent=chances;
      spinBtn.disabled=false;spinBtn.textContent='ç«‹å³æŠ½å¥–';
    }

    spinBtn.addEventListener('click',spin);
    closeModal.addEventListener('click',()=>modal.classList.remove('open'));
    modal.addEventListener('click',e=>{if(e.target===modal)modal.classList.remove('open')});

    // åˆ†äº«é¡µ
    const shareBtn=document.getElementById('shareBtn');
    const toLottery=document.getElementById('toLottery');
    const copyLink=document.getElementById('copyLink');
    shareBtn.addEventListener('click',e=>{e.preventDefault();show(sharePage)});
    toLottery.addEventListener('click',e=>{e.preventDefault();show(lotteryPage)});
    copyLink.addEventListener('click',()=>{
      const url=location.href;
      navigator.clipboard.writeText(url);
      alert('åˆ†äº«é“¾æ¥å·²å¤åˆ¶ï¼Œä¸€åˆ»ä¹Ÿåˆ«åœï¼å¿«å‘éœéœå¥½å‹ï¼');
    });

    // æ¨¡æ‹Ÿå¥½å‹å¸®åŠ©å¢åŠ æ¬¡æ•°ï¼ˆå¯æ‰©å±•ä¸ºå®é™…å‚æ•°æ£€æµ‹ï¼‰
    if(location.search.includes('fromFriend')){
      chances++;
      chanceEl.textContent=chances;
      alert('å†¤ç§æœ‹å‹å·²ä¸Šé’©ï¼Œä½ è·å¾—äº†1æ¬¡é¢å¤–æŠ½å¥–æœºä¼šï¼');
    }

    // è‹¥æ— äºŒç»´ç ï¼Œæ˜¾ç¤ºå ä½å›¾
    (function checkQR(){
      const img=qrImg;
      img.onerror=()=>{img.src='data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160"><rect width="100%" height="100%" fill="white"/><text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle" font-size="12" fill="#ccc">è¯·æ›¿æ¢ä¸ºçœŸå®äºŒç»´ç </text></svg>'}
    })();
  </script>
</body>
</html>
